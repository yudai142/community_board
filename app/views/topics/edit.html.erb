<head>
<script type="text/javascript">
$(function() {
 function readURL(input) {
   if (input.files && input.files[0]) {
     var reader = new FileReader();
     reader.onload = function (e) {
       $('#img_prev').attr('src', e.target.result);
     }
     reader.readAsDataURL(input.files[0]);
   }
 }
 $("#topic_image").change(function(){
   readURL(this);
 });
});
</script>
</head>

<div class="vsc-initialized">
  <section>
  	<a class="alignC" href="/"><img src="/assets/bar/bar_interact.png" width="100%" alt="情報交換BBS"></a>
  </section>
  
  <section id="content_area">
  	<div id="content_main_area" class="in_box_sizing" style="z-index:2;">
        <div id="content_main_area_in">
          <div class="category_area">
			      <table width="100%" border="0" cellpadding="0" cellspacing="0" summary="">
			      	<tr>
			      		<td class="td_txt_explanation" style="width:60%">
			      			トピックの編集
			      		</td>
				  	    <td class="btn_submit_area" style="align:right;vertical-align:middle;">
						    	<%= button_to '戻る', delete_select_topics_path, method: :get, class:"btn_delete in_box_sizing", style:"width:95%;" %>
				  	    </td>
                <td class="btn_submit_area" style="align:right;vertical-align:middle;">
                  <%= form_for [ :confirm, @topic ] do |f| %>
			      		  <input type="submit" value="投稿を確認する" class="btn_submit in_box_sizing" style="width:95%" >
			      	  </td>
			      	</tr>
			      	<!-- コメント数が最大に達した時に下記エラー分を表示させてください。
			      	<tr>
			      		<td colspan="3" class="txt_error">コメント数が最大数となり、コメントがこれ以上行えません。新しくトピックを作成する必要があります。</td>
              </tr>
              -->
            </table>
          </div><!-- category_area -->

          <div class="category_area" style="position:relative;">
            <table width="100%" border="0" cellpadding="0" cellspacing="0" summary="">
              <tr>
                <td class="td_category"><img src="/assets/category/category_name2.png" alt="投稿入力フォーム"></td>
                <td style="cursor: pointer;" class="td_txt_explanation">
	        	      <span class="txt_contribution_title">
                    下記フォームに入力し、投稿確認ボタンを押してください。
                  </span>
	        	    </td>
              </tr>
              <tr>
                <td class="td_category" style="padding-top:5px;"><img src="/assets/category/category_contribution_name.png" alt="トピック名"></td>
                <td class="td_txt_explanation" valign="top" style="padding-top:5px;">
                  <%= f.text_field :title, class:"contribution_input_txt_area in_box_sizing", placeholder:"トピック名を入力してください。"%>
                </td>
              </tr>
              <tr>
                <td class="td_category" style="padding-top:5px;"><img src="/assets/category/category_contribution_content.png" alt="本文"></td>
                <td class="td_txt_explanation" style="padding-top:5px;">
                  <%= f.text_area :content, class:"renewal_comment_area in_box_sizing", placeholder:"投稿するトピックの本文をこちらに入力してください。"%>
                </td>
              </tr>
              <tr>
                <td class="td_category" style="padding-top:5px;"><img src="/assets/category/category_contribution_content.png" alt="本文"></td>
                <td class="td_txt_explanation" style="padding-top:5px;">
                  <%= f.collection_select :category_id, Category.all, :id, :name %>
                </td>
              </tr>
              <tr>
                <td class="td_category" style="padding-top:5px;"><img src="/assets/category/category_contribution_content.png" alt="本文"></td>
                <td class="td_txt_explanation" style="padding-top:5px;">
                  <span class="small bold" id="input_form">
                    <% if @topic.image.present? %>
                      （画像の削除は次の投稿確認画面でできます）
                    <%else%>
                      （任意）画像を1つ追加できます。
                    <%end%>
                  </span>
                  <%= f.file_field :image, id: :topic_image %><%= f.hidden_field :image_cache %>
                </td>
              </tr>
            </table>
            <div colspan="3" class="alignC">
              <% if @topic.image.present? %>
                <%= image_tag @topic.image.url, id: :img_prev, style:"max-height: 20rem;max-width: 20rem;border-radius: 5px;" %>
              <%else%>
                <%= image_tag "", id: :img_prev, style:"max-height: 20rem;max-width: 20rem;border-radius: 5px;" %>
              <%end%>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </section>
</div>
